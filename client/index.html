<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracverse Admin Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Tracverse Admin Dashboard</h1>
            <p class="subtitle">Track and manage your URL analytics</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('referrals')">üë• Referrals</button>
            <button class="tab" onclick="switchTab('generate')">üîó Generate URL</button>
            <button class="tab" onclick="switchTab('clicks')">üìä Click Logs</button>
            <button class="tab" onclick="switchTab('config')">‚öôÔ∏è UTM Config</button>
        </div>

        <!-- Referrals Tab -->
        <div id="referrals" class="content active">
            <div class="card">
                <h2>Register New User</h2>
                <div class="success-message" id="registerSuccess">User registered successfully!</div>
                <div class="error-message" id="registerError">Registration failed</div>
                
                <form id="registerForm">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="registerEmail" placeholder="user@example.com" required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="registerPassword" placeholder="Password" required>
                    </div>
                    <div class="form-group">
                        <label>Sponsor Referral Code (Optional)</label>
                        <input type="text" id="sponsorCode" placeholder="TRV123456">
                        <small id="sponsorValidation" style="display: none;"></small>
                    </div>
                    <button type="submit" class="btn-primary">Register User</button>
                </form>

                <div id="registrationResult" style="display: none;">
                    <h3>Registration Successful!</h3>
                    <p><strong>User ID:</strong> <span id="newUserId"></span></p>
                    <p><strong>Referral Code:</strong> <code id="newUserCode"></code></p>
                    <p><strong>Sponsor:</strong> <span id="sponsorInfo"></span></p>
                </div>
            </div>

            <div class="card">
                <h2>Referral Tree Viewer</h2>
                <div class="form-group">
                    <label>Enter User ID to view tree</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="treeUserId" placeholder="User ID">
                        <button onclick="loadReferralTree()" class="btn-primary">Load Tree</button>
                    </div>
                </div>
                
                <div id="treeContainer" style="display: none;">
                    <h3>Tree Statistics</h3>
                    <div id="treeStats" class="stats">
                        <div class="stat-card">
                            <div class="stat-label">Direct Referrals</div>
                            <div class="stat-value" id="directReferrals">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Team</div>
                            <div class="stat-value" id="totalTeam">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Active Members</div>
                            <div class="stat-value" id="activeMembers">0</div>
                        </div>
                    </div>

                    <h3>Downline</h3>
                    <div id="downlineList"></div>

                    <h3>Upline Chain</h3>
                    <div id="uplineList"></div>
                </div>
            </div>
        </div>

        <!-- Generate URL Tab -->
        <div id="generate" class="content">
            <div class="card">
                <h2>Generate Tracking URL</h2>
                <div class="success-message" id="generateSuccess">URL generated successfully!</div>
                <div class="error-message" id="generateError">Failed to generate URL</div>
                
                <form id="generateForm">
                    <div class="form-group">
                        <label>Original URL</label>
                        <input type="url" id="originalUrl" placeholder="https://example.com" required>
                    </div>
                    <div class="form-group">
                        <label>User ID</label>
                        <input type="text" id="userId" placeholder="user123" required>
                    </div>
                    <div class="form-group">
                        <label>Platform</label>
                        <select id="platform">
                            <option value="web">Web</option>
                            <option value="mobile">Mobile</option>
                            <option value="email">Email</option>
                            <option value="social">Social</option>
                            <option value="api">API</option>
                        </select>
                    </div>
                    <button type="submit" class="btn-primary">Generate Tracking URL</button>
                </form>

                <div id="generatedResult" style="display: none;">
                    <h3>Generated URL:</h3>
                    <div class="url-result">
                        <input type="text" id="generatedUrl" readonly>
                        <button onclick="copyUrl()" class="btn-copy">Copy</button>
                    </div>
                    <p><strong>Tracking ID:</strong> <code id="trackingId"></code></p>
                </div>
            </div>
        </div>

        <!-- Click Logs Tab -->
        <div id="clicks" class="content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-label">Total Clicks</div>
                    <div class="stat-value" id="totalClicks">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">iOS Users</div>
                    <div class="stat-value" id="iosClicks">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Android Users</div>
                    <div class="stat-value" id="androidClicks">0</div>
                </div>
            </div>

            <div class="card">
                <h2>Filters</h2>
                <div class="filters">
                    <input type="text" id="filterUserId" placeholder="User ID">
                    <select id="filterPlatform">
                        <option value="">All Platforms</option>
                        <option value="iOS">iOS</option>
                        <option value="Android">Android</option>
                    </select>
                    <button onclick="loadClicks()">Apply Filters</button>
                    <button onclick="clearFilters()">Clear</button>
                </div>
            </div>

            <div class="card">
                <h2>Click Logs</h2>
                <div id="clicksTableContainer">
                    <div class="loading">Loading...</div>
                </div>
                <div class="pagination" id="pagination"></div>
            </div>
        </div>

        <!-- UTM Config Tab -->
        <div id="config" class="content">
            <div class="card">
                <h2>Current UTM Configuration</h2>
                <div id="currentConfig" class="loading">Loading...</div>
            </div>

            <div class="card">
                <h2>Update UTM Configuration</h2>
                <div class="success-message" id="configSuccess">Configuration updated successfully!</div>
                <div class="error-message" id="configError">Failed to update configuration</div>
                
                <form id="configForm">
                    <div class="form-group">
                        <label>UTM Source</label>
                        <input type="text" id="utmSource" placeholder="e.g., my_app" required>
                    </div>
                    <div class="form-group">
                        <label>UTM Medium</label>
                        <input type="text" id="utmMedium" placeholder="e.g., in_app_link" required>
                    </div>
                    <div class="form-group">
                        <label>UTM Campaign Prefix</label>
                        <input type="text" id="utmCampaignPrefix" placeholder="e.g., yt_user_" required>
                    </div>
                    <button type="submit" class="btn-primary">Update Configuration</button>
                </form>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
